version: "2"

services:
    hommod_flask:
        build:
            context: .
            dockerfile: Dockerfile-flask
        ports:
            - "7001:7001"
        links:
            - "rabbitmq:amq"
            - "redis:redis"
        volumes:
            - "/data:/data"
    hommod_celery:
        build:
            context: .
            dockerfile: Dockerfile-celery
        links:
            - "redis:redis"
            - "rabbitmq:amq"
            - "hommod_flask"
            - "hommod_databanks"
        volumes:
            - "/data:/data"
            - "/mnt/cmbi4:/mnt/cmbi4"
    hommod_databanks:
        build:
            context: .
            dockerfile: Dockerfile-databanks
        volumes:
            - "/data:/data"
    redis:
        image: redis
    rabbitmq:
        image: rabbitmq
